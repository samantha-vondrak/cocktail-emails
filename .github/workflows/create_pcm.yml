#https://github.com/marketplace/actions/auto-update

name: autoupdate
on:
  # This will trigger on all pushes to master.
   push:
     branches:
       - master

permissions: write-all

jobs:
  autoupdate:
    name: autoupdate
    runs-on: ubuntu-18.04
    steps:
        - name: Git checkout
          uses: actions/checkout@v2
          with:
            fetch-depth: '0'
        - name: git
          run: |
            git config user.name "GitHub Actions Bot"
            git config user.email "<>"
        - name: Set env author
          run: echo "AUTHOR=$(git log -1 --oneline --pretty=tformat:"%an")"
        - name: Set env subject
          run: echo "SUBJECT=$(git log -1 --oneline --pretty=tformat:"%s")"
        - name: Test
          run: echo $AUTHOR
        - uses: actions/checkout@v2
        - name: run ./.github/scripts/create_changerc.py
          run: python ./.github/scripts/create_changerc.py
          env:
            AUTHOR: "$AUTHOR"
            SUBJECT: "$SUBJECT"
        - name: run ./.github/scripts/create_copy_changerc.py
          run: python ./.github/scripts/create_copy_changerc.py
        - name: delete changerc
          run: rm .changerc
