#https://github.com/marketplace/actions/auto-update

name: autoupdate
on:
  # This will trigger on all pushes to master.
   push:
     branches:
       - master

jobs:
  autoupdate:
    name: autoupdate
    runs-on: ubuntu-18.04
    steps:
    # https://kjaymiller.com/how-i-autoupdate-my-github-readme-using-github-actions-in-5-easy-steps
        - name: pip install pygithub
          run: pip install pygithub
        - name: run ./scripts/resolve_changerc_conflic.py
          run: python resolve_changerc_conflict.py
          env:
            GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

        - uses: docker://chinthakagodawita/autoupdate-action:v1
          env:
            GITHUB_TOKEN: "${{ secrets.GITHUB_TOKEN }}"
            DRY_RUN: "false"
            PR_FILTER: "all"
            MERGE_MSG: "Branch was auto-updated."
            RETRY_COUNT: "5"
            RETRY_SLEEP: "300"
            MERGE_CONFLICT_ACTION: "fail"
